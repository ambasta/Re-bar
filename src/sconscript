import os

Import('env')
env = env.Clone()

projectLibs = ['rebar', 'marge', 'utils', 'kinesis']

# projectLibs = ['utils', 'kinesis']

libraries = list()

for subdir in projectLibs:
    print('Building> ' + subdir);
    library = env.SConscript(
        '{folderName}/sconscript'.format(folderName=subdir),
        {'env': env}
    )

    if isinstance(library, list):
        lstring = []
        for lib in library:
            lstring.append('{}'.format(lib))
        print('Adding library: {}'.format(','.join(lstring)))
        libraries.extend(library)
    else:
        print('Adding library: {}'.format(library))
        libraries.append(library)

env.Append(LIBS=libraries)
env.Append(LIBS=['boost_graph', 'bsoncxx', 'mongocxx', 'mongoc-1.0', 'aws-cpp-sdk-core', 'aws-cpp-sdk-kinesis', 'pthread', 'boost_date_time'])
# env.Append(LIBS=['aws-cpp-sdk-core', 'aws-cpp-sdk-kinesis', 'pthread'])

env.Program('fletcher', ['fletcher.cxx'])
